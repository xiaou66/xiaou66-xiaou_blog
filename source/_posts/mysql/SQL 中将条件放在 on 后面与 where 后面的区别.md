---
title: SQL 中将条件放在 on 后面与 where 后面的区别
date: 2022/03/10 17:58:38
categories:
  - [mysql]
tags:
  - [sql]
---
# SQL 中将条件放在 on 后面与 where 后面的区别

> 这个区别主要体现在 left join 或 right join 在 inner join 中其效果是一样的

## on 和 where 条件运行时机

> 数据库在通过连接两张或多张表来返回记录时，都会生成一张中间的临时表，然后再将这张临时表返回给用户。

1. on 条件是在生成临时表时使用的条件，它不管 on 中的条件是否为真，都会返回左边表中的记录。
2. where 条件是在临时表生成好后，再对临时表进行过滤的条件。

### 实验

**表 A**

```
+----+------+
| id | b_id |
+----+------+
|  1 | 10   |
|  2 | 20   |
|  3 | 20   |
+----+------+
```

**表 B**

```
+----+------+
| id | v2   |
+----+------+
| 10 | A    |
| 20 | C    |
| 20 | C    |
+----+------+
```

条件写在 where 中

```sql
SELECT * 
FROM a
	LEFT JOIN b ON ( a.b_id = b.id ) 
WHERE
	b.v2 = 'A';
```

```
+----+------+------+------+
| id | b_id | id   | v2   |
+----+------+------+------+
|  1 | 10   |   10 | A    |
+----+------+------+------+
```

条件写在 on 中

```sql
SELECT * FROM a
LEFT JOIN b ON ( a.b_id = b.id AND b.v2 = 'A' );
```

```
+----+------+------+------+
| id | b_id | id   | v2   |
+----+------+------+------+
|  1 | 10   |   10 | A    |
|  2 | 20   | NULL | NULL |
|  3 | 20   | NULL | NULL |
+----+------+------+------+
```

可以发现 on 是在生成连接表的起作用的，where 是生成连接表之后对连接表再进行过滤。